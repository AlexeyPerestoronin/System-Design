# Collaboration Editor

Система для совместной работы над стикерами на доске.

## Функциональные требования
* Пользователи должны уметь редактировать любой тип документа (docs, xlsx, odt, ...) на любой платформе (IOS, Android, Windows, Linux, WEB, ...) в режиме коллаборации.

## НеФункциональные требования
* Изменения вносимые пользователями при совместно редактировании документа должны отображаться _на лету_:
    * $99_{percentile} = 1s$
    * $50_{percentile} = 10ms$
* $DAU \leqslant 100.000_{users}$

![](./collaboration%20editor.drawio.png)

## Happy Path:
1. Начало работы Клиента с Редактором:
   1. открывает Редактор (в зависимости от ОС)
   2. загружает необходимые плагины для работы с документом
   3. загружает и создаёт новый документ
2. Запуск режима коллаборации
   1. подключается к Системе с запросом начала режима коллаборации (получает ссылку совместного доступа)
   2. отгружает рабочий документ в DOM Collaboration Manager Service
   3. производит работу с документом:  
        ```
        # Клиент отправляет на Сервер запрос на изменения DOM
        Client --(gRPC-API)--> DOM Collaboration Manager Service:
        changeDOM(
            navigate: DOMAddressOpt,    // DOM-адрес начала области действия изменений
            select: DOMAddressOpt,      // DOM-адрес конца области действий изменений
            edit: DOMDataOpt,           // DOM-структура для замены между адресом начала и конца
        ) -> ChangeResult               // Результата выполнения изменений в DOM с данными для синхронизации

        STRUCT ChangeResult {
            ChangeOperationStatus: ENUM // Статус результата выполнения операции
            syncDataOpt: STRUCT {       // Данные для синхронизации DOM-структуры на клиенте (зависит от статуса)
                navigate: DOMAddressOpt // DOM-адрес начала области синхронизации
                select: DOMAddressOpt   // DOM-адрес конца области синхронизации
                edit: DOMDataOpt        // DOM-структура для замены между адресом начала и конца
            }
        }
        ```

# System Services
## EntryPoint
Точка доступа в Систему:
* API Gateway
* GRPC Gateway


## DOM Collaboration Manager Service
Администрирует режим совместной работы над документом несколькими пользователями: отслеживает изменения между версиями документа у разных пользователей и синхронизирует их.

## Editor-APP Access Service
Клиентская точка доступа для скачивания дистрибутивов Редактора (основной сайт).

# Data Bases
## Editor-App DB
Хранит дистрибутивы Редактора для разных ОС (UI + DOM Manager Core) и выступает в качестве сервера для скачивания (FTP).

## Editor-Plugins DB
Хранит БД доступных плагинов для Редактора.